<div class="p-6 bg-gray-50 min-h-full">
  <div class="flex justify-between items-center mb-6 border-b pb-4">
    <h2 class="text-3xl font-bold text-gray-800 flex items-center">
      <i class="fas fa-user-tie mr-3 text-indigo-600"></i>
      Perfil del Empleado
      <span *ngIf="employee" class="ml-3 text-indigo-600 text-xl">#{{ employee.id }}</span>
    </h2>
    <div *ngIf="employee" class="flex ">
      <button routerLink="/hhrr" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 transition">
        <i class="fas fa-arrow-left mr-2"></i> Volver a Lista
      </button>
      <button [routerLink]="['/hhrr/employee/edit', employee.id]" 
              class="ml-3 px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition flex items-center">
        <i class="fas fa-edit mr-2"></i> Editar Perfil
      </button>
    </div>
  </div>

  <div *ngIf="isLoading" class="text-center py-12 text-gray-500">
    <i class="fas fa-spinner fa-spin text-4xl mb-3"></i>
    <p>Cargando perfil del empleado...</p>
  </div>

  <div *ngIf="error && !isLoading" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
    <strong class="font-bold">Error:</strong>
    <span class="block sm:inline"> {{ error }}</span>
  </div>

  <div *ngIf="employee && !isLoading">
    
    <div class="bg-white shadow-xl rounded-xl overflow-hidden mb-6">
      <div class="bg-indigo-500 h-20"></div>
      <div class="p-6 -mt-16 flex items-start">
        <img src="https://images.vexels.com/media/users/3/137047/isolated/preview/5831a17a290077c646a48c4db78a81bb-icono-de-perfil-de-usuario-azul.png" alt="Foto de perfil" class="h-32 w-32 rounded-full border-4 border-white object-cover shadow-lg">
        <div class="ml-6 pt-10">
          <h1 class="text-4xl font-extrabold text-gray-900">{{ employee.first_name }} {{ employee.last_name }}</h1>
          <p class="text-xl text-indigo-600 font-semibold">{{ employee.position }}</p>
          <div class="mt-2 flex items-center text-sm text-gray-500">
            <span [ngClass]="getStatusClass(employee.status)" class="ml-4 px-3 py-1 text-xs font-semibold rounded-full uppercase">
              {{ employee.status === 'Active' ? 'Activo' : (employee.status === 'On Leave' ? 'Abandono' : 'Retirado/Despedido') }}
            </span>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-100 px-6 py-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600">
          <div><i class="fas fa-calendar-alt mr-2 text-indigo-500"></i> <span class="font-bold">Contratación: </span>{{ employee.hired_at | date:'mediumDate' }}</div>
          <div><i class="fas fa-envelope mr-2 text-indigo-500"></i> <span class="font-bold">Email: </span><a [href]="'mailto:' + employee.email" class="text-indigo-600 hover:underline">{{ employee.email }}</a></div>
          <div><i class="fas fa-user-tag mr-2 text-indigo-500"></i> <span class="font-bold">Reporta a: </span>{{ employee.manager_name }}</div>
      </div>
    </div>

    <div class="flex border-b border-gray-200 mb-6 overflow-x-auto whitespace-nowrap">
      <button (click)="activeTab = 'personal'" 
              [ngClass]="{'border-indigo-500 text-indigo-600': activeTab === 'personal', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'personal'}" 
              class="py-3 px-4 text-sm font-medium border-b-2 transition duration-150 flex-shrink-0">
        <i class="fas fa-address-card mr-2"></i> Datos Personales
      </button>
      <button (click)="activeTab = 'employment'" 
              [ngClass]="{'border-indigo-500 text-indigo-600': activeTab === 'employment', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'employment'}" 
              class="py-3 px-4 text-sm font-medium border-b-2 transition duration-150 flex-shrink-0">
        <i class="fas fa-clipboard-list mr-2"></i> Detalles Laborales
      </button>
      <button (click)="activeTab = 'compensation'" 
              [ngClass]="{'border-indigo-500 text-indigo-600': activeTab === 'compensation', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'compensation'}" 
              class="py-3 px-4 text-sm font-medium border-b-2 transition duration-150 flex-shrink-0">
        <i class="fas fa-money-check-alt mr-2"></i> Compensación
      </button>
      <button (click)="activeTab = 'performance'" 
              [ngClass]="{'border-indigo-500 text-indigo-600': activeTab === 'performance', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'performance'}" 
              class="py-3 px-4 text-sm font-medium border-b-2 transition duration-150 flex-shrink-0">
        <i class="fas fa-chart-line mr-2"></i> Desempeño
      </button>
      <button (click)="activeTab = 'documents'" 
              [ngClass]="{'border-indigo-500 text-indigo-600': activeTab === 'documents', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'documents'}" 
              class="py-3 px-4 text-sm font-medium border-b-2 transition duration-150 flex-shrink-0">
        <i class="fas fa-file-alt mr-2"></i> Documentos
      </button>
    </div>

    <div class="bg-white shadow-xl rounded-xl p-6">
      
      <div *ngIf="activeTab === 'personal'" class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6">
        <h3 class="col-span-full text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Información de Contacto</h3>
        
        <div class="text-sm">
          <p class="font-medium text-gray-500">Número de Cédula/DNI</p>
          <p class="text-gray-900 font-semibold">{{ employee.identification }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Fecha de Nacimiento</p>
          <p class="text-gray-900 font-semibold">{{ employee.birth_date | date:'longDate' }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Teléfono</p>
          <p class="text-gray-900 font-semibold">{{ employee.phone }}</p>
        </div>
        <div class="text-sm col-span-full">
          <p class="font-medium text-gray-500">Dirección Residencial</p>
          <p class="text-gray-900 font-semibold">{{ employee.address }}</p>
        </div>

        <h3 class="col-span-full text-xl font-semibold text-gray-800 my-4 border-b pb-2">Contacto de Emergencia</h3>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Nombre</p>
          <p class="text-gray-900 font-semibold">{{ employee.emergency_contact.name }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Teléfono</p>
          <p class="text-gray-900 font-semibold">{{ employee.emergency_contact.phone }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Relación</p>
          <p class="text-gray-900 font-semibold">{{ employee.emergency_contact.relationship }}</p>
        </div>
      </div>

      <div *ngIf="activeTab === 'employment'" class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6">
        <h3 class="col-span-full text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Información Laboral</h3>
        
        <div class="text-sm">
          <p class="font-medium text-gray-500">Fecha de Contratación</p>
          <p class="text-gray-900 font-semibold">{{ employee.hired_at | date:'longDate' }} ({{ getMonthOfService(employee.hired_at) }} meses)</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Puesto de Trabajo</p>
          <p class="text-gray-900 font-semibold">{{ employee.position }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Supervisor Directo</p>
          <p class="text-gray-900 font-semibold">{{ employee.manager_name }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Estado Actual</p>
          <span [ngClass]="getStatusClass(employee.status)" class="px-3 py-1 text-sm font-semibold rounded-full uppercase">
              {{ employee.status }}
          </span>
        </div>
      </div>
      
      <div *ngIf="activeTab === 'compensation'" class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6">
        <h3 class="col-span-full text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Detalles de Remuneración</h3>
        
        <div class="text-sm">
          <p class="font-medium text-gray-500">Salario Base</p>
          <p class="text-gray-900 font-bold text-2xl text-green-600">{{ employee.salary | currency:'USD':'symbol':'1.2-2' }}</p>
        </div>
        <div class="text-sm">
          <p class="font-medium text-gray-500">Esquema de Bonificación</p>
          <p class="text-gray-900 font-semibold">{{ employee.bonus_scheme }}</p>
        </div>
        
        <h3 class="col-span-full text-xl font-semibold text-gray-800 my-4 border-b pb-2">Historial de Pagos</h3>
        <div class="col-span-full">
            <p class="text-gray-500 italic">Aquí se integraría una lista de los últimos recibos de nómina (Requiere integración con el módulo de Nómina/Contabilidad).</p>
        </div>
      </div>

      <div *ngIf="activeTab === 'performance'">
        <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Historial de Evaluaciones de Desempeño</h3>
        
        <div *ngIf="employee?.performace_reviews?.length === 0" class="text-gray-500 italic">
          No hay evaluaciones registradas.
        </div>
        
        <ul role="list" class="divide-y divide-gray-200">
          <li *ngFor="let review of employee?.performace_reviews" class="py-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <i class="fas fa-trophy text-yellow-500 mr-3 text-xl"></i>
                <div>
                  <p class="text-lg font-semibold text-gray-900">Evaluación del {{ review.date | date:'longDate' }}</p>
                  <p class="text-sm text-gray-500">{{ review.summary }}</p>
                </div>
              </div>
              <div class="text-right">
                <p class="text-sm font-medium text-indigo-600">Rating: {{ review.rating }} / 5</p>
                <p class="text-yellow-400 text-lg">{{ getRatingStars(review.rating) }}</p>
              </div>
            </div>
          </li>
        </ul>
      </div>

      <div *ngIf="activeTab === 'documents'">
        <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Documentación del Empleado</h3>
        
        <div *ngIf="employee.documents.length === 0" class="text-gray-500 italic">
          No hay documentos adjuntos.
        </div>

        <ul role="list" class="divide-y divide-gray-200">
          <li *ngFor="let doc of employee.documents" class="py-3 flex items-center justify-between">
            <div class="flex items-center">
              <i class="fas fa-file-pdf text-red-500 mr-3 text-xl" *ngIf="doc.type === 'PDF'"></i>
              <i class="fas fa-image text-blue-500 mr-3 text-xl" *ngIf="doc.type === 'JPG'"></i>
              <i class="fas fa-file-word text-indigo-500 mr-3 text-xl" *ngIf="doc.type === 'DOCX'"></i>
              <div>
                <p class="text-sm font-medium text-gray-900">{{ doc.name }}</p>
                <p class="text-xs text-gray-500">Subido: {{ doc.uploaded_date | date:'mediumDate' }} | Tipo: {{ doc.type }}</p>
              </div>
            </div>
            <a [href]="doc.url" target="_blank" class="text-indigo-600 hover:text-indigo-900 text-sm font-medium transition">
              <i class="fas fa-download mr-1"></i> Descargar
            </a>
          </li>
        </ul>
        
        <div class="mt-6 pt-4 border-t border-gray-100">
             <button class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition flex items-center">
              <i class="fas fa-upload mr-2"></i> Subir Documento
            </button>
        </div>
      </div>
    </div>
  </div>
</div>